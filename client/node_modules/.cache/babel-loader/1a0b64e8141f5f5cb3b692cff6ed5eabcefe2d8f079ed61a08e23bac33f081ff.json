{"ast":null,"code":"import _regeneratorRuntime from\"/home/janxa/Bureau/Projets/Smol/smol/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/janxa/Bureau/Projets/Smol/smol/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/janxa/Bureau/Projets/Smol/smol/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Component}from\"react\";import{toast}from'react-toastify';import{useEffect,useState}from\"react\";import{contact_schema}from\"../../joi_schemas/contact_schema\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Contact(props){var Joi=require(\"joi\");var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),mail_sender=_useState2[0],setmail_sender=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),mail_content=_useState4[0],setmail_content=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),errors=_useState6[0],setErrors=_useState6[1];var schema=contact_schema;var sendEmail=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var new_errors,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:new_errors={};event.preventDefault();_context.prev=2;_context.next=5;return schema.validateAsync({mail_sender:mail_sender,mail_content:mail_content},{abortEarly:false});case 5:_context.next=7;return toast.promise(axios.post(\"/api/contact/send\",{mail_content:mail_content,mail_sender:mail_sender}),{pending:'Loading',success:'ðŸ“§ Your email has been sent !',error:'ðŸ¤¯ Error, could not send email '});case 7:res=_context.sent;console.log(res);setmail_sender(\"\");setmail_content(\"\");props.ClosePopup();_context.next=19;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);console.log(_context.t0);_context.t0.details.forEach(function(error){return new_errors[error.context.label]=error.message;});setErrors(new_errors);case 19:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);}));return function sendEmail(_x){return _ref.apply(this,arguments);};}();// might implement real time error handling\nuseEffect(function(){console.log(\"error\",errors);});return/*#__PURE__*/_jsxs(\"form\",{onSubmit:sendEmail,className:\"[&>*]:p-1 flex flex-col w-full h-full overflow-hidden p-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-medium text-primary-brown-2\",children:\"Contact\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Any question ? Send me an e-mail through this form and i'll answer you asap !\"}),/*#__PURE__*/_jsx(\"label\",{for:\"mail_sender\",title:\"So I can answer your mail !\",children:\"Your email adress :\"}),/*#__PURE__*/_jsx(\"input\",{className:errors[\"mail_sender\"]?\"input-invalid\":\"input\",type:\"text\",name:\"mail_sender\",id:\"mail_sender\",value:mail_sender,onChange:function onChange(e){return setmail_sender(e.target.value);}}),errors[\"mail_sender\"]&&/*#__PURE__*/_jsx(\"p\",{className:\"error-label\",children:errors[\"mail_sender\"]}),/*#__PURE__*/_jsx(\"label\",{for:\"contact_message\",title:\"Cant exceed 10 000 characters\",children:\"Your Message :\"}),/*#__PURE__*/_jsx(\"textarea\",{className:errors[\"mail_sender\"]?\"input-invalid\":\"input\",name:\"contact_message\",id:\"contact_message\",cols:\"30\",rows:\"10\",value:mail_content,onChange:function onChange(e){return setmail_content(e.target.value);}}),errors[\"mail_content\"]&&/*#__PURE__*/_jsx(\"p\",{className:\"error-label\",children:errors[\"mail_content\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Send Email !\",className:\"btn-validation mt-2\"})]});}export default Contact;","map":{"version":3,"names":["React","Component","toast","useEffect","useState","contact_schema","axios","Contact","props","Joi","require","mail_sender","setmail_sender","mail_content","setmail_content","errors","setErrors","schema","sendEmail","event","new_errors","preventDefault","validateAsync","abortEarly","promise","post","pending","success","error","res","console","log","ClosePopup","details","forEach","context","label","message","e","target","value"],"sources":["/home/janxa/Bureau/Projets/Smol/smol/client/src/components/popups/Contact.jsx"],"sourcesContent":["import React, { Component } from \"react\";\nimport {  toast } from 'react-toastify';\nimport { useEffect,useState} from \"react\";\nimport { contact_schema } from \"../../joi_schemas/contact_schema\"\nimport axios from \"axios\";\n\nfunction Contact(props) {\n  const Joi = require(\"joi\");\n  const [mail_sender,setmail_sender]= useState(\"\")\n  const [mail_content,setmail_content]= useState(\"\")\n  const [errors,setErrors]=useState({})\n  const schema = contact_schema;\n\n  const sendEmail= async (event)=>{\n    let new_errors= {}\n    event.preventDefault();\n    try {\n    await schema.validateAsync({mail_sender:mail_sender,mail_content:mail_content},{abortEarly:false});\n    const res = await toast.promise( axios.post(\"/api/contact/send\", {mail_content,mail_sender}),\n    {\n      pending: 'Loading',\n      success: 'ðŸ“§ Your email has been sent !',\n      error: 'ðŸ¤¯ Error, could not send email '\n    }\n);\n    console.log(res);\n    setmail_sender(\"\");\n    setmail_content(\"\");\n      props.ClosePopup();\n  }catch (err){\n    console.log(err)\n    err.details.forEach(\n       (error) => (new_errors[error.context.label] = error.message)\n      );\n    setErrors(new_errors);\n  }\n}\n\n  // might implement real time error handling\n   useEffect(()=>{\n    \n      console.log(\"error\", errors);\n     \n   }\n  )\n  return (\n   <form onSubmit={sendEmail} className=\"[&>*]:p-1 flex flex-col w-full h-full overflow-hidden p-2\" >\n      <h3 className=\"text-2xl font-medium text-primary-brown-2\">Contact</h3>\n      <p>Any question ? Send me an e-mail through this form and i'll answer you asap !</p>\n      <label for=\"mail_sender\" title=\"So I can answer your mail !\">Your email adress :</label>\n      <input className={errors[\"mail_sender\"] ? \"input-invalid\":\"input\"} type=\"text\"  name=\"mail_sender\" id=\"mail_sender\" value={mail_sender} onChange={(e) =>setmail_sender(e.target.value)} />\n      {errors[\"mail_sender\"] && <p className=\"error-label\">{errors[\"mail_sender\"]}</p>}\n\n      <label for=\"contact_message\" title=\"Cant exceed 10 000 characters\" >Your Message :</label>\n      <textarea className={errors[\"mail_sender\"] ? \"input-invalid\":\"input\"}\n        name=\"contact_message\"\n        id=\"contact_message\"\n        cols=\"30\"\n        rows=\"10\"\n        value={mail_content}\n        onChange={(e) =>setmail_content(e.target.value)}\n        \n      ></textarea>\n      {errors[\"mail_content\"] && <p className=\"error-label\">{errors[\"mail_content\"]}</p>}\n\n      <input type=\"submit\" value=\"Send Email !\" className=\"btn-validation mt-2\"/>\n\n    </form>\n      \n  );\n}\n\nexport default Contact;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}